<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Product Generator Pro - WooCommerce</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <!-- AI Assistant Chat -->
  <div id="aiAssistant" class="ai-assistant-container">
    <button id="assistantToggle" class="assistant-toggle">
      <i class="fas fa-robot"></i>
    </button>
    <div id="assistantPanel" class="assistant-panel hidden">
      <div class="assistant-header">
        <h3><i class="fas fa-robot"></i> AI Assistant</h3>
        <button onclick="AIAssistant.close()"><i class="fas fa-times"></i></button>
      </div>
      <div id="assistantMessages" class="assistant-messages"></div>
      <div class="assistant-input">
        <input type="text" id="assistantInput" placeholder="Ask me anything..." onkeypress="if(event.key==='Enter') AIAssistant.send()">
        <button onclick="AIAssistant.send()"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
  </div>

  <div class="max-w-7xl mx-auto p-4">

    <!-- Sticky Header -->
    <div class="sticky-header">
      <div class="text-center mb-4">
        <h1 class="text-4xl font-bold mb-2 text-indigo-700 flex justify-center items-center gap-3">
          <div id="appVersion" class="mt-2"></div>
          <i class="fas fa-cart-plus"></i>
          AI Product Generator Pro
          <i class="fas fa-magic"></i>
        </h1>
        <p class="text-zinc-500">WooCommerce Automation • AI-Powered • Quality Control</p>
        <p class="text-xs text-zinc-400 mt-1">
          User: <strong>Zakriibrahim</strong> |
          <span id="currentDateTime">2025-10-16 16:25:25</span>
        </p>
      </div>

      <div class="flex gap-3 justify-center items-center flex-wrap">
        <select id="exportLang" class="px-4 py-2 rounded-lg border bg-white font-semibold">
          <option value="en">English</option>
          <option value="fr">Français</option>
          <option value="ar">العربية</option>
        </select>

        <button id="fetchProductsBtn" class="btn btn-purple">
          <i class="fas fa-download"></i> Fetch from Store
        </button>

        <button id="uploadBtn" class="btn btn-purple" disabled>
          <i class="fas fa-upload"></i> Upload to WooCommerce
        </button>

        <button id="exportCsvBtn" class="btn btn-green">
          <i class="fas fa-file-csv"></i> Export CSV
        </button>

        <button id="saveSessionBtn" class="btn btn-gray">
          <i class="fas fa-save"></i> Save Session
        </button>

        <button id="loadSessionBtn" class="btn btn-gray">
          <i class="fas fa-folder-open"></i> Load Session
        </button>

        <input type="file" id="loadSessionFile" accept=".json" style="display:none;">
      </div>
    </div>

    <!-- Main Tabs -->
    <div class="bg-white rounded-xl shadow-lg p-4 mb-6">
      <div class="tab-container">
        <button class="tab-btn active" data-tab="upload">
          <i class="fas fa-upload"></i> Upload
        </button>

        <button class="tab-btn" data-tab="fetched">
          <i class="fas fa-cloud-download-alt"></i> Fetched Products (<span id="fetchedProductCount">0</span>)
        </button>

        <button class="tab-btn" data-tab="products">
          <i class="fas fa-list"></i> Products (<span id="productCount">0</span>)
        </button>

        <button class="tab-btn" data-tab="quality">
          <i class="fas fa-check-circle"></i> Quality Check
        </button>
        <button class="tab-btn" data-tab="templates">
          <i class="fas fa-layer-group"></i> Templates
        </button>
        <button class="tab-btn" data-tab="bulk">
          <i class="fas fa-edit"></i> Bulk Edit
        </button>
      </div>

      <!-- Upload Tab -->
      <div id="tab-upload" class="tab-content active">
        <div class="bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-4 mb-6 shadow-lg">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <div>
              <h3 class="text-xl font-bold mb-1">
                <i class="fas fa-wand-magic-sparkles"></i> Advanced Image Optimization
              </h3>
              <p class="text-sm text-green-50">Auto-optimize, resize, compress & enhance all uploaded images</p>
            </div>
            <div class="flex gap-3">
              <label class="flex items-center gap-2 bg-white/20 px-4 py-2 rounded-lg cursor-pointer hover:bg-white/30 transition">
                <input type="checkbox" id="optimizationToggle" checked class="w-5 h-5">
                <span class="font-semibold">Enable Auto-Optimization</span>
              </label>
              <button id="optimizationSettingsBtn" class="btn btn-yellow">
                <i class="fas fa-cog"></i> Settings
              </button>
            </div>
          </div>
        </div>
        
        <div class="flex flex-wrap gap-3 mb-6">
          <button id="addSingleBatchBtn" class="btn btn-green">
            <i class="fas fa-images"></i> Add Single Product Batch
          </button>
          <button id="addGroupBtn" class="btn btn-indigo">
            <i class="fas fa-plus"></i> Add Multi-Image Product
          </button>
          <button id="syncCategoriesBtn" class="btn btn-blue">
            <i class="fas fa-sync"></i> Sync Categories from Store
          </button>
          <button id="loadTemplateBtn" class="btn btn-yellow">
            <i class="fas fa-magic"></i> Load Template
          </button>
        </div>

        <div class="grid lg:grid-cols-2 gap-6">
          <div class="upload-section">
            <h2 class="section-header">
              <i class="fas fa-box"></i> Single Products
              <span class="text-sm font-normal text-zinc-500">(each image = 1 product)</span>
            </h2>
            <div id="single-batches-container" class="batch-container">
              <div class="empty-placeholder">
                <i class="fas fa-images text-4xl text-zinc-300 mb-2"></i>
                <p class="text-zinc-400 text-sm">Click "Add Single Product Batch" to start</p>
              </div>
            </div>
          </div>

          <div class="upload-section">
            <h2 class="section-header">
              <i class="fas fa-layer-group"></i> Multi-Image Products
              <span class="text-sm font-normal text-zinc-500">(all images = 1 product)</span>
            </h2>
            <div id="groups-container" class="batch-container">
              <div class="empty-placeholder">
                <i class="fas fa-layer-group text-4xl text-zinc-300 mb-2"></i>
                <p class="text-zinc-400 text-sm">Click "Add Multi-Image Product" to start</p>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-8 text-center">
          <button id="generateBtn" class="btn btn-indigo btn-lg" disabled>
            <i class="fas fa-wand-magic-sparkles"></i> Generate Products with AI
          </button>
          <p class="text-xs text-zinc-400 mt-2">AI will analyze images and create product data automatically</p>
        </div>
      </div>

      <!-- Fetched Products Tab -->
      <div id="tab-fetched" class="tab-content">
        <div class="flex justify-between items-center mb-6">
          <div>
            <h2 class="text-3xl font-bold text-indigo-700 mb-2">Fetched Products from Store</h2>
            <p class="text-zinc-600">Products loaded from your WooCommerce store. Edit and re-upload to update.</p>
          </div>
          <div class="flex gap-3">
            <button onclick="FetchedManager.clearAll()" class="btn btn-pink btn-sm">
              <i class="fas fa-trash"></i> Clear All Fetched
            </button>
            <button onclick="FetchedManager.uploadSelected()" class="btn btn-indigo btn-sm">
              <i class="fas fa-upload"></i> Update in Store
            </button>
          </div>
        </div>

        <div class="bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-xl p-4 mb-6 shadow-lg">
          <div class="flex items-center justify-between">
            <div>
              <i class="fas fa-cloud-download-alt text-2xl mb-2"></i>
              <h3 class="text-2xl font-bold"><span id="fetchedProductCount">0</span> Fetched Products</h3>
            </div>
          </div>
        </div>

        <div id="fetched-content" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

        <div id="fetched-empty" class="empty-state">
          <i class="fas fa-cloud-download-alt"></i>
          <h3>No Fetched Products Yet</h3>
          <p>Click "Fetch from Store" to load products from WooCommerce</p>
          <button onclick="FetchProducts.showFetchModal()" class="btn btn-purple btn-sm">
            <i class="fas fa-download"></i> Fetch Products Now
          </button>
        </div>
      </div>

      <!-- Products Tab -->
      <div id="tab-products" class="tab-content">
        <div id="loading" class="loading-container hidden">
          <div class="spinner"></div>
          <p id="loadingMessage" class="text-lg font-medium text-zinc-600 mt-4">AI is working...</p>
          <div id="progressBarContainer" class="progress-container hidden">
            <div class="progress-bar">
              <div id="progressFill" class="progress-fill"></div>
            </div>
            <p id="progressText" class="text-sm text-zinc-500 mt-2">0 / 0 products generated</p>
          </div>
          <button id="stopBtn" class="btn btn-pink mt-4">
            <i class="fas fa-stop"></i> Stop Generation
          </button>
          <div id="batchPause" class="mt-4 hidden">
            <p class="font-bold text-yellow-700 text-lg">
              <i class="fas fa-clock"></i> API rate limit reached!
              Waiting <span id="pauseCountdown">30</span>s...
            </p>
          </div>
        </div>

        <div id="error" class="error-banner hidden">
          <i class="fas fa-exclamation-circle text-xl"></i>
          <div class="flex-1" id="errorText"></div>
          <button onclick="hideError()" class="text-red-700 hover:text-red-900">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div id="content" class="products-grid"></div>

        <div id="emptyState" class="empty-state">
          <i class="fas fa-box-open"></i>
          <h3>No products generated yet</h3>
          <p>Upload images in the Upload tab and click "Generate Products"</p>
          <button onclick="switchTab('upload')" class="btn btn-indigo btn-sm mt-4">
            <i class="fas fa-arrow-left"></i> Go to Upload
          </button>
        </div>
      </div>

      <!-- Quality Check Tab -->
      <div id="tab-quality" class="tab-content">
        <div class="quality-dashboard">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-indigo-700">
              <i class="fas fa-shield-alt"></i> Quality Control Dashboard
            </h2>
            <button id="runQualityCheck" class="btn btn-indigo">
              <i class="fas fa-check-double"></i> Run Quality Check
            </button>
          </div>

          <div id="qualityResults" class="quality-grid"></div>

          <div id="qualityIssues" class="mt-6 hidden">
            <h3 class="font-bold text-lg mb-3 text-red-600">
              <i class="fas fa-exclamation-triangle"></i> Issues Found
            </h3>
            <div id="qualityIssuesList" class="space-y-2"></div>
          </div>
        </div>
      </div>

      <!-- Templates Tab -->
      <div id="tab-templates" class="tab-content">
        <div class="templates-section">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-indigo-700">
              <i class="fas fa-layer-group"></i> Product Templates
            </h2>
            <button id="createTemplateBtn" class="btn btn-green">
              <i class="fas fa-plus"></i> Create New Template
            </button>
          </div>

          <div id="templatesContainer" class="templates-grid"></div>
        </div>
      </div>

      <!-- Bulk Edit Tab -->
      <div id="tab-bulk" class="tab-content">
        <div class="bulk-edit-section">
          <h2 class="text-2xl font-bold text-indigo-700 mb-6">
            <i class="fas fa-edit"></i> Bulk Edit Tools
          </h2>

          <div class="grid md:grid-cols-2 gap-6">
            <div class="bulk-tool-card">
              <h3 class="font-bold text-lg mb-3">
                <i class="fas fa-search-plus"></i> Find & Replace
              </h3>
              <input type="text" id="bulkFindText" placeholder="Find text..." class="bulk-input mb-2">
              <input type="text" id="bulkReplaceText" placeholder="Replace with..." class="bulk-input mb-3">
              <select id="bulkFindField" class="bulk-input mb-3">
                <option value="title">Title</option>
                <option value="description">Description</option>
                <option value="short_description">Short Description</option>
                <option value="tags">Tags</option>
              </select>
              <button id="bulkFindReplaceBtn" class="btn btn-blue w-full">
                <i class="fas fa-exchange-alt"></i> Replace All
              </button>
            </div>

            <div class="bulk-tool-card">
              <h3 class="font-bold text-lg mb-3">
                <i class="fas fa-dollar-sign"></i> Price Adjustment
              </h3>
              <select id="bulkPriceOperation" class="bulk-input mb-2">
                <option value="add">Add Amount</option>
                <option value="subtract">Subtract Amount</option>
                <option value="multiply">Multiply by %</option>
                <option value="set">Set Fixed Price</option>
              </select>
              <input type="number" id="bulkPriceValue" placeholder="Value..." class="bulk-input mb-3">
              <button id="bulkPriceBtn" class="btn btn-green w-full">
                <i class="fas fa-calculator"></i> Apply to All
              </button>
            </div>

            <div class="bulk-tool-card">
              <h3 class="font-bold text-lg mb-3">
                <i class="fas fa-tags"></i> Add Tags
              </h3>
              <input type="text" id="bulkAddTags" placeholder="Tags (comma separated)" class="bulk-input mb-3">
              <button id="bulkAddTagsBtn" class="btn btn-indigo w-full">
                <i class="fas fa-plus"></i> Add to All Products
              </button>
            </div>

            <div class="bulk-tool-card">
              <h3 class="font-bold text-lg mb-3">
                <i class="fas fa-list"></i> Change Categories
              </h3>
              <div id="bulkCategorySelect" class="bulk-input mb-3 max-h-40 overflow-y-auto"></div>
              <button id="bulkCategoriesBtn" class="btn btn-purple w-full">
                <i class="fas fa-folder"></i> Apply to All
              </button>
            </div>
          </div>

          <div class="mt-6 p-4 bg-zinc-50 rounded-lg border">
            <p class="text-sm text-zinc-600">
              <i class="fas fa-info-circle text-indigo-600"></i>
              <strong>Tip:</strong> All bulk operations apply to ALL generated products.
              Use the Products tab to select specific products for individual edits.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Actions Floating Bar -->
  <div id="bulkActionsBar" class="bulk-actions-bar hidden">
    <div class="flex items-center gap-3">
      <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll(this)" class="w-5 h-5">
      <label for="selectAllCheckbox" class="font-bold">Select All</label>
    </div>
    <span class="font-bold text-indigo-700">
      <span id="bulkSelectedCount">0</span> selected
    </span>
    <button id="bulkDeleteBtn" class="btn btn-pink btn-sm">
      <i class="fas fa-trash"></i> Delete
    </button>
    <button id="bulkCategoryAssignBtn" class="btn btn-blue btn-sm">
      <i class="fas fa-folder"></i> Assign Categories
    </button>
    <button onclick="clearSelection()" class="btn btn-gray btn-sm">
      <i class="fas fa-times"></i> Clear
    </button>
  </div>

  <!-- Modal Container -->
  <div id="modalBg" class="modal-bg hidden" onclick="closeModal()"></div>
  <div id="modalContainer" class="modal-container hidden"></div>

  <!-- Scripts -->
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/imageHandler.js"></script>
  <script src="js/imageOptimizer.js"></script>
  <script src="js/aiProcessor.js"></script>
  <script src="js/categoryManager.js"></script>
  <script src="js/productManager.js"></script>
  <script src="js/exporters.js"></script>
  <script src="js/aiAssistant.js"></script>
  <script src="js/qualityCheck.js"></script>
  <script src="js/templates.js"></script>
  <script src="js/bulkEdit.js"></script>

  <!-- Managers and helpers -->
  <script src="js/fetchedManager.js"></script>
  <script src="js/tabManager.js"></script>
  <script src="js/version.js"></script>
  <script src="js/fetchProducts.js"></script>
  <script src="js/regenerate.js"></script>
  <script src="js/imageEnhancer.js"></script>
  <script src="js/socialPoster.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
